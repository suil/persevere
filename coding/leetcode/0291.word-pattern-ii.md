# Word Pattern II
[291. Word Pattern II](https://leetcode.com/problems/word-pattern-ii/)

Given a pattern and a string s, return true if s matches the pattern.

# Key insights
*

# Code
```javascript
/**
 * @param {string} pattern
 * @param {string} s
 * @return {boolean}
 */
var wordPatternMatch = function(pattern, s) {
    const map = new Map();
    const used = new Set();

    function backtrack(pi, si) {
        // If both strings fully matched
        if (pi === pattern.length && si === s.length) return true;
        // One finished but the other didnâ€™t
        if (pi === pattern.length || si === s.length) return false;

        const ch = pattern[pi];

        // If pattern char already mapped
        if (map.has(ch)) {
            const mapped = map.get(ch);
            if (!s.startsWith(mapped, si)) return false;
            return backtrack(pi + 1, si + mapped.length);
        }

        // Otherwise try all possible substrings for this new char
        for (let end = si + 1; end <= s.length; end++) {
            const candidate = s.slice(si, end);

            if (used.has(candidate)) continue;

            // Choose
            map.set(ch, candidate);
            used.add(candidate);

            if (backtrack(pi + 1, end)) return true;

            // Backtrack
            map.delete(ch);
            used.delete(candidate);
        }

        return false;
    }

    return backtrack(0, 0);
};

```

# Complexity
**Time:**
**Space:**
