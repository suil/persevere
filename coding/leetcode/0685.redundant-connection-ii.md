# Redundant Connection II
[685. Redundant Connection II](https://leetcode.com/problems/redundant-connection-ii/)

In this problem, a rooted tree is a directed graph such that, there is exactly one node (the root) for which all other nodes are descendants of this node, plus every node has exactly one parent, except for the root node which has no parents.

# Key insights
- Handle two cases: a node with two parents (duplicate parent) and a cycle in the directed graph
- First pass identifies if any node has two parents; if so, record both candidate edges and skip the second one
- Second pass uses Union-Find to detect a cycle; the answer depends on whether there was a duplicate parent, a cycle, or both

# Code
```javascript
/**
 * @param {number[][]} edges
 * @return {number[]}
 */
var findRedundantDirectedConnection = function(edges) {
  const n = edges.length;
  const uf = new UnionFind(n + 1);
  const parent = Array(n + 1).fill(0);
  let first = null, second = null, last = null;

  // Find edge causing duplicate parent and potential cycle
  for (let i = 0; i < edges.length; i++) {
    const [u, v] = edges[i];
    if (parent[v]) {
      first = [parent[v], v];
      second = [u, v];
      edges[i] = [0, 0]; // Mark to skip
    } else {
      parent[v] = u;
    }
  }

  // Find cycle
  for (const [u, v] of edges) {
    if (!u && !v) continue;
    if (!uf.union(u, v)) last = [u, v];
  }

  // Return the redundant edge based on cases
  if (!first) return last;
  return last ? first : second;
};
class UnionFind {
    constructor(n) {
        this.root = [];
        for (let i = 0; i < n; i++) {
            this.root[i] = i;
        }
    }
    find(x) {
        while (x !== this.root[x]) {
            x = this.root[x];
        }
        return x;
    }
    union(x, y) {
        const xRoot = this.find(x);
        const yRoot = this.find(y);
        if (xRoot !== yRoot) {
            this.root[yRoot] = xRoot;
            return true;
        }
        return false;
    }
}
```

# Complexity
**Time:** O(n * alpha(n)) -- two passes with Union-Find operations (nearly O(n))
**Space:** O(n) -- for the Union-Find and parent arrays
