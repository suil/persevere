# Basic Calculator
[224. Basic Calculator](https://leetcode.com/problems/basic-calculator/)

Given a string s representing a valid expression, implement a basic calculator to evaluate it, and return the result of the evaluation.

# Key insights
- Use a stack to accumulate numbers with their signs (+num or -num), and an opStack to save/restore state at parentheses
- On '(', push current stack and prevOp onto opStack, then reset for the sub-expression
- On ')', reduce the inner stack to a single number and restore the outer context from opStack

# Code
```javascript
/**
 * @param {string} s
 * @return {number}
 */
var calculate = function(s) {
    let stack = [];
    let opStack = [];
    let num = 0;
    let prevOp = '+';

    for (let i = 0; i <= s.length; i++) {
        const char = s[i] || '';

        if (/\d/.test(char)) {
            num = num * 10 + Number(char);
        }

        // applier
        if (['+', '-', ')'].includes(char) || i === s.length) {
            if (prevOp === '+') {
                stack.push(num);
            } else if (prevOp === '-') {
                stack.push(-num);
            }

            num = 0;
            prevOp = char !== ')' ? char : '+';
        }

        if (char === '(') {
            opStack.push([[...stack], prevOp]);
            num = 0;
            prevOp = '+';
            stack = [];
        }

        if (char === ')') {
            const [lastStack, lastOp] = opStack.pop();
            num = stack.reduce((s, n) => s + n, 0);
            prevOp = lastOp;
            stack = [...lastStack];
        }
    }

    return stack.reduce((s, n) => s + n, 0);
};
```

# Complexity
**Time:** O(n)
**Space:** O(n)
