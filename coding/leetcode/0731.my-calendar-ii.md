# My Calendar II
[731. My Calendar II](https://leetcode.com/problems/my-calendar-ii/)

You are implementing a program to use as your calendar. We can add a new event if adding the event will not cause a triple booking.

# Key insights
- Maintain two lists: bookings (all events) and overlaps (regions where two events already overlap)
- A triple booking occurs only if the new event overlaps with any region in the overlaps list
- When adding a new event, compute its intersection with each existing booking and add those intersections to overlaps

# Code
```javascript

var MyCalendarTwo = function() {
    this.bookings = []; // [start, end, bookedCount]
    this.overlaps = [];
};

/** 
 * @param {number} startTime 
 * @param {number} endTime
 * @return {boolean}
 */
MyCalendarTwo.prototype.book = function(startTime, endTime) {
    // Check if the new event causes a triple booking
    for (const [oStart, oEnd] of this.overlaps) {
        if (Math.max(startTime, oStart) < Math.min(endTime, oEnd)) {
            return false; // Triple booking detected
        }
    }

    // Check for overlaps with existing bookings and add to overlaps
    for (const [bStart, bEnd] of this.bookings) {
        const overlapStart = Math.max(startTime, bStart);
        const overlapEnd = Math.min(endTime, bEnd);
        if (overlapStart < overlapEnd) {
            this.overlaps.push([overlapStart, overlapEnd]);
        }
    }

    // Add the new event to bookings
    this.bookings.push([startTime, endTime]);
    return true;
};

/** 
 * Your MyCalendarTwo object will be instantiated and called as such:
 * var obj = new MyCalendarTwo()
 * var param_1 = obj.book(startTime,endTime)

 [10, 20], [50, 60], [10, 40], [5, 15], [5, 10], [25, 55]

 bookings:[5, 10, 1], [10, 20, 3], [50, 60, 1], , 
 over booked: [10, 40], [5, 15]

 */
```

# Complexity
**Time:** O(n) per book call where n is the number of existing bookings**Space:** O(n) for bookings and overlaps lists
